{
    "$defs": {
        "probability": {
            "type": "number",
            "minimum": 0,
            "maximum": 1
        },
        "natural_number": {
            "type": "integer",
            "minimum": 1
        },
        "dataset_type": {
            "type": "object",
            "properties": {
                "name": {
                    "type": "string"
                },
                "shape": {
                    "type": "array",
                    "minItems": 2,
                    "maxItems": 2
                },
                "normalise": {
                    "type": "boolean"
                },
                "augment": {
                    "type": "boolean"
                },
                "task": {
                    "enum": [
                        "classification",
                        "real_time_classification",
                        "semantic_segmentation",
                        "real_time_semantic_segmentation"
                    ]
                },
                "batch_size": {
                    "type": "integer"
                }
            }
        }
    },
    "type": "object",
    "properties": {
        "checkpoints_path": {
            "type": "string"
        },
        "statistics_format": {
            "enum": [
                "csv",
                "json"
            ]
        },
        "evolutionary": {
            "type": "object",
            "properties": {
                "generations": {
                    "$ref": "#/$defs/natural_number"
                },
                "elite_lambda": {
                    "$ref": "#/$defs/natural_number"
                },
                "lambda": {
                    "$ref": "#/$defs/natural_number"
                },
                "max_epochs": {
                    "$ref": "#/$defs/natural_number"
                },
                "individual_seed": {
                    "type": "string"
                },
                "mutation": {
                    "type": "object",
                    "properties": {
                        "add_connection": {
                            "$ref": "#/$defs/probability"
                        },
                        "remove_connection": {
                            "$ref": "#/$defs/probability"
                        },
                        "add_layer": {
                            "$ref": "#/$defs/probability"
                        },
                        "reuse_layer": {
                            "$ref": "#/$defs/probability"
                        },
                        "remove_layer": {
                            "$ref": "#/$defs/probability"
                        },
                        "dsge_layer": {
                            "$ref": "#/$defs/probability"
                        },
                        "macro_layer": {
                            "$ref": "#/$defs/probability"
                        }
                    },
                    "additionalProperties": false,
                    "required": [
                        "add_connection",
                        "remove_connection",
                        "add_layer",
                        "reuse_layer",
                        "remove_layer",
                        "dsge_layer",
                        "macro_layer"
                    ]
                },
                "track_mutations": {
                    "type": "boolean"
                }
            },
            "additionalProperties": false,
            "required": [
                "generations",
                "lambda",
                "max_epochs",
                "mutation",
                "track_mutations"
            ]
        },
        "network": {
            "type": "object",
            "properties": {
                "architecture": {
                    "type": "object",
                    "properties": {
                        "reuse_layer": {
                            "$ref": "#/$defs/probability"
                        },
                        "macro_structure": {
                            "type": "array"
                        },
                        "static_modules": {
                            "type": "array"
                        },
                        "head_module": {
                            "type": "string"
                        },
                        "pretrain_head_module": {
                            "type": "string"
                        },
                        "modules": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "input_modules": {
                                        "type": "array",
                                        "minItems": 1
                                    },
                                    "network_structure_init": {
                                        "type": "array",
                                        "minItems": 1
                                    },
                                    "network_structure": {
                                        "type": "array",
                                        "minItems": 2,
                                        "maxItems": 2
                                    },
                                    "self_skip_connection_max_layers_back": {
                                        "type": "integer"
                                    },
                                    "skip_connections_source_modules": {
                                        "type": "array"
                                    },
                                    "max_skip_connections": {
                                        "type": "integer"
                                    },
                                    "init_with_skip_connections": {
                                        "type": "boolean"
                                    },
                                    "fusion_rule": {
                                        "type": "string"
                                    },
                                    "input_fusion_rule": {
                                        "type": "string"
                                    }
                                },
                                "additionalProperties": false,
                                "required": [
                                    "name",
                                    "input_modules",
                                    "network_structure_init",
                                    "network_structure",
                                    "self_skip_connection_max_layers_back",
                                    "skip_connections_source_modules",
                                    "max_skip_connections",
                                    "init_with_skip_connections",
                                    "fusion_rule",
                                    "input_fusion_rule"
                                ]
                            }
                        }
                    },
                    "additionalProperties": false,
                    "required": [
                        "reuse_layer",
                        "macro_structure",
                        "static_modules",
                        "head_module",
                        "pretrain_head_module",
                        "modules"
                    ]
                },
                "learning": {
                    "type": "object",
                    "properties": {
                        "default_train_time": {
                            "type": "integer"
                        },
                        "train_time_multiplier": {
                            "type": "number"
                        },
                        "max_train_time": {
                            "type": "integer"
                        }
                    },
                    "required": [
                        "default_train_time",
                        "train_time_multiplier"
                    ]
                }
            },
            "additionalProperties": false,
            "required": [
                "architecture",
                "learning"
            ]
        },
        "dataset": {
            "type": "object",
            "properties": {
                "evolution": {
                    "enum": [
                        "normal",
                        "pretrain"
                    ]
                },
                "normal": {
                    "$ref": "#/$defs/dataset_type"
                },
                "pretrain": {
                    "$ref": "#/$defs/dataset_type"
                },
                "num_workers": {
                    "type": "integer"
                }
            },
            "additionalProperties": false,
            "required": [
                "evolution",
                "normal",
                "pretrain",
                "num_workers"
            ]
        }
    },
    "additionalProperties": false,
    "required": [
        "checkpoints_path",
        "statistics_format",
        "evolutionary",
        "network",
        "dataset"
    ]
}